@startuml JsonModelDiagram

' Definição da hierarquia JSON
abstract class JsonValue {
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonObject {
  - properties: MutableMap<String, JsonValue>
  + get(key: String): JsonValue?
  + set(key: String, value: JsonValue)
  + size(): Int
  + keys(): Set<String>
  + values(): Collection<JsonValue>
  + filter(predicate: (String, JsonValue) -> Boolean): JsonObject
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonArray {
  - elements: MutableList<JsonValue>
  + add(value: JsonValue)
  + get(index: Int): JsonValue
  + set(index: Int, value: JsonValue)
  + size(): Int
  + elements(): List<JsonValue>
  + filter(predicate: (JsonValue) -> Boolean): JsonArray
  + map(transform: (JsonValue) -> JsonValue): JsonArray
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonString {
  - value: String
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonNumber {
  - value: Number
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonBoolean {
  - value: Boolean
  + serialize(): String
  + accept(v: JsonVisitor)
}

class JsonNull {
  + INSTANCE: JsonNull
  + serialize(): String
  + accept(v: JsonVisitor)
}

' Visitor interface
interface JsonVisitor {
  + visitObject(jsonObject: JsonObject)
  + visitArray(jsonArray: JsonArray)
  + visitString(jsonString: JsonString)
  + visitNumber(jsonNumber: JsonNumber)
  + visitBoolean(jsonBoolean: JsonBoolean)
  + visitNull(jsonNull: JsonNull)
}

' Visitors concretos
class ValidatorVisitor {
  - valid: Boolean
  + isValid(): Boolean
  + reset()
  + visitObject(jsonObject: JsonObject)
  + visitArray(jsonArray: JsonArray)
  + visitString(jsonString: JsonString)
  + visitNumber(jsonNumber: JsonNumber)
  + visitBoolean(jsonBoolean: JsonBoolean)
  + visitNull(jsonNull: JsonNull)
}

class ArrayHomogeneityVisitor {
  - homogeneous: Boolean
  + isHomogeneous(): Boolean
  + reset()
  + visitObject(jsonObject: JsonObject)
  + visitArray(jsonArray: JsonArray)
  + visitString(jsonString: JsonString)
  + visitNumber(jsonNumber: JsonNumber)
  + visitBoolean(jsonBoolean: JsonBoolean)
  + visitNull(jsonNull: JsonNull)
}

' Relações de herança
JsonValue <|-- JsonObject
JsonValue <|-- JsonArray
JsonValue <|-- JsonString
JsonValue <|-- JsonNumber
JsonValue <|-- JsonBoolean
JsonValue <|-- JsonNull

' JsonVisitor associações (uso de dependency):
JsonVisitor ..> JsonObject
JsonVisitor ..> JsonArray
JsonVisitor ..> JsonString
JsonVisitor ..> JsonNumber
JsonVisitor ..> JsonBoolean
JsonVisitor ..> JsonNull

' Visitors implementam JsonVisitor
ValidatorVisitor ..|> JsonVisitor
ArrayHomogeneityVisitor ..|> JsonVisitor

@enduml
